version: 2

sources:
  - name: arth_bq
    database: arth-insight-v2
    schema: stock_raw_data
    
    tables:
      - name: stock_intelligence_v3
        config:
          loaded_at_field: last_updated
          freshness:
            warn_after: {count: 24, period: hour}
            error_after: {count: 72, period: hour}
            # ðŸŸ¢ The filter saves your BigQuery Quota
            filter: last_updated >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 7 DAY)